{% extends "base.html" %}

{% block title %}Driver Dashboard{% endblock %}

{% block content %}
<h2>Welcome, {{ user.username }}!</h2>

<div class="dashboard-container">
    <!-- Assigned Jobs -->
    <section>
        <h3>ğŸ“Œ Your Assigned Jobs</h3>
        <ul class="job-list">
            {% for job in accepted_jobs %}
            <li>
                ğŸš— <strong>{{ job.description }}</strong>
                <br>ğŸ“ Route:
                <ul>
                    {% for stop in job.stops %}
                    <li>{{ stop.sequence }}ï¸âƒ£ {{ stop.location }} {% if stop.completed %} âœ… {% else %}
                        <form action="{{ url_for('complete_stop', stop_id=stop.id) }}" method="POST">
                            <button type="submit">âœ” Mark Complete</button>
                        </form>
                        {% endif %}
                    </li>
                    {% endfor %}
                </ul>
                <br>ğŸ•’ Status: <strong>{{ job.status }}</strong>
            </li>
            {% else %}
            <li>No assigned jobs yet.</li>
            {% endfor %}
        </ul>
    </section>

    <!-- Available Jobs -->
    <section>
        <h3>ğŸ›  Available Jobs</h3>
        <ul class="job-list">
            {% for job in available_jobs %}
            <li>
                ğŸš™ <strong>{{ job.description }}</strong>
                <br>ğŸ“ Pickup: {{ job.stops[0].location }} â†’ Dropoff: {{ job.stops[-1].location }}
                <br>ğŸ•’ Estimated Time: {{ job.estimated_drive_time }} mins
                <form action="{{ url_for('accept_job', job_id=job.id) }}" method="POST">
                    <button type="submit">âœ… Accept Job</button>
                </form>
            </li>
            {% else %}
            <li>No jobs available right now.</li>
            {% endfor %}
        </ul>
    </section>

    <!-- Account Actions -->
    <section>
        <h3>âš™ Account Actions</h3>
        <button onclick="location.href='#'">ğŸ“… Request Time-Off</button>
        <button onclick="location.href='#'">ğŸ•’ View Work Hours</button>
    </section>
</div>

{% endblock %}
